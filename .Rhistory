dims = 2,
perplexity = 50,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 50,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 50,
verbose = FALSE,
max_iter = 9000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 80,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 100,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 150,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 150,
verbose = FALSE,
max_iter = 10000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 60,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 20,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 35,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 35,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 25,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 28,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 8000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 9000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 10000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 10000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 32,
verbose = FALSE,
max_iter = 10000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 6000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 30,
verbose = FALSE,
max_iter = 8000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 28,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 40,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 45,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 38,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 36,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 34,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 34,
verbose = FALSE,
max_iter = 8000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 50,
verbose = FALSE,
max_iter = 8000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 35,
verbose = FALSE,
max_iter = 8000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(Rtsne)
set.seed(123)
mnist_tsne <- Rtsne(fashion_mnist %>% select(-label, -Item),
dims = 2,
perplexity = 35,
verbose = FALSE,
max_iter = 5000)
mnist_tsne_2d <- data.frame(Item = fashion_mnist$Item,
x = mnist_tsne$Y[,1],
y = mnist_tsne$Y[,2])
ggplot(mnist_tsne_2d, aes(x = x, y = y, col = Item)) +
geom_point(size = 1)
library(tidyverse)
# Load Fashion MNIST training dataset downloaded from https://www.kaggle.com/datasets/zalando-research/fashionmnist
fashion_mnist <- read_csv("~/Datasets/Fashion_MNIST/fashion-mnist_train.csv")
# We will take 2000 observations from the 'train' data
set.seed(123)
sample_id <- sample(nrow(fashion_mnist), 2000)
fashion_mnist <- fashion_mnist[sample_id,]
fashion_mnist$label <- as.factor(fashion_mnist$label)
fashion_mnist[,2:ncol(fashion_mnist)] <- fashion_mnist[,2:ncol(fashion_mnist)]/255
fashion_mnist <- fashion_mnist %>%
mutate(Item = case_when(
label == 0 ~ "Top",
label == 1 ~ "Trouser",
label == 2 ~ "Pullover",
label == 3 ~ "Dress",
label == 4 ~ "Coat",
label == 5 ~ "Sandal",
label == 6 ~ "Shirt",
label == 7 ~ "Sneaker",
label == 8 ~ "Bag",
label == 9 ~ "Boot"))
# Define a function to visualise the images
view <- function(data){
view_df <- data[1:9,] %>%
mutate(img_id = row_number()) %>%
pivot_longer(cols = starts_with("pixel"),
names_to = "pixel",
names_prefix = "pixel",
values_to = "value") %>%
arrange(pixel) %>%
mutate(pixel = as.numeric(pixel) - 1,
x = pixel %% 28,
y = 28 - (pixel %/% 28))
ggplot(view_df, aes(x = x, y = y, fill = value)) +
geom_tile() +
facet_wrap(vars(img_id, Item), labeller = "label_both") +
scale_fill_gradient(low = "white", high = "black") +
coord_fixed() +
theme(legend.position = "none")
}
view(fashion_mnist)
citation("Rtsne")
citation("tidyverse")
citation("mvtnorm")
library(tidyverse)
# Load Fashion MNIST training dataset downloaded
# from https://www.kaggle.com/datasets/zalando-research/fashionmnist
fashion_mnist <- read_csv("~/Datasets/Fashion_MNIST/fashion-mnist_train.csv")
# We will take 2000 observations from the 'train' data
set.seed(123)
sample_id <- sample(nrow(fashion_mnist), 2000)
# Select samples from original dataset
fashion_mnist <- fashion_mnist[sample_id,]
# Set labels as factor type
fashion_mnist$label <- as.factor(fashion_mnist$label)
# Convert pixel values based on scale between 0 and 1
fashion_mnist[,2:ncol(fashion_mnist)] <- fashion_mnist[,2:ncol(fashion_mnist)]/255
# Add Item variable with description of item type
fashion_mnist <- fashion_mnist %>%
mutate(Item = case_when(
label == 0 ~ "T-shirt",
label == 1 ~ "Trouser",
label == 2 ~ "Pullover",
label == 3 ~ "Dress",
label == 4 ~ "Coat",
label == 5 ~ "Sandal",
label == 6 ~ "Shirt",
label == 7 ~ "Sneaker",
label == 8 ~ "Bag",
label == 9 ~ "Boot"))
# Define a function to visualise the images
view <- function(data){
view_df <- data[1:9,] %>% # Select first 9 entries as an example
pivot_longer(cols = starts_with("pixel"), # Pivot table longer based on pixel values
names_to = "pixel",
names_prefix = "pixel",
values_to = "value") %>%
arrange(pixel) %>% # Sort pixels in order so pixel numbers are grouped rather than label/item
mutate(pixel = as.numeric(pixel) - 1, # Add x and y variables to show location of pixel value in 2D space
x = pixel %% 28,
y = 28 - (pixel %/% 28))
ggplot(view_df, aes(x = x, y = y, fill = value)) +
geom_tile() +
facet_wrap(vars(img_id, Item), labeller = "label_both") +
scale_fill_gradient(low = "white", high = "black") +
coord_fixed() +
theme(legend.position = "none")
}
view(fashion_mnist)
?coord_fixed
blogdown:::preview_site()
